(()=>{var y=["silver","gray"],h=(o,t,e)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height),o.forEach(i=>x(i,t,e))},x=(o,t,e)=>{let i=Math.min(o.tilePosition[0].x,o.tilePosition[1].x),n=Math.min(o.tilePosition[0].y,o.tilePosition[1].y),r=Math.max(o.tilePosition[0].x,o.tilePosition[1].x),c=Math.max(o.tilePosition[0].y,o.tilePosition[1].y),l={x:i*e,y:n*e},p={x:r*e+e,y:c*e+e};t.lineWidth=2,t.beginPath(),t.roundRect(l.x,l.y,p.x-l.x,p.y-l.y,10),t.fillStyle=y[o.id%y.length],t.fill(),t.strokeStyle="black",t.stroke()};var s=class{constructor(t,e){this.x=t;this.y=e}isEqual(t){return this.x===t.x&&this.y===t.y}},d=class{constructor(t,e=Math.floor(Math.random()*32)){this.tilePosition=t;this.id=e}overlaps(t){return t.tilePosition.some(e=>this.tilePosition.some(i=>i.isEqual(e)))}},b=class o{constructor(t,e,i){this.width=t;this.height=e;this.tiles=i}occupiedPositions(){return this.tiles.flatMap(t=>t.tilePosition)}isInBounds(t){return t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height}isFreePosition(t){return this.isInBounds(t)&&!this.occupiedPositions().some(e=>e.isEqual(t))}freePositions(){let t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let n=new s(e,i);this.isFreePosition(n)&&t.push(n)}return t}isComplete(){return this.occupiedPositions().length===this.width*this.height}generateChildren(){let t=this.freePositions().map(n=>({value:n,rank:Math.random()})).toSorted((n,r)=>n.rank-r.rank).map(({value:n})=>n);if(t.length===0)return[];let e=null,i=[];for(let n of t){let r=[new s(n.x-1,n.y),new s(n.x+1,n.y),new s(n.x,n.y-1),new s(n.x,n.y+1)].filter(c=>this.isFreePosition(c));(e===null||r.length<i.length)&&(e=n,i=r)}return i.map(n=>{let r=new d([e,n]);return new o(this.width,this.height,[...this.tiles,r])})}},a=class{constructor(t,e,i=[],n=!1,r=!0){this.parent=t;this.tiling=e;this.children=i;this.visited=n;this.viable=r}};function*g(o,t){let i=new a(null,new b(o,t,[]));for(;!i.tiling.isComplete();){if(yield i.tiling.tiles,!i.viable&&(i=i.parent,!i))throw new Error("No complete tiling found");i.visited||(i.children=i.tiling.generateChildren().map(r=>new a(i,r)),i.visited=!0);let n=i.children.filter(r=>r.viable);if(n.length===0){i.viable=!1;continue}i=n[Math.floor(Math.random()*n.length)]}return i.tiling.tiles}var v=document.getElementById("generate-button"),E=document.querySelector("canvas"),f=E.getContext("2d"),u=null,T=1e3,m=30,P=T/m,w=async()=>{u&&u.abort(),u=new AbortController;let o=u.signal;try{let t=g(m,m),e=t.next();for(h(e.value,f,P);!e.done;){if(o.aborted)return;await new Promise((i,n)=>{let r=setTimeout(i,1);o.addEventListener("abort",()=>{clearTimeout(r),n(new DOMException("Operation cancelled","AbortError"))})}),e=t.next(),h(e.value,f,P)}}catch(t){if(t instanceof DOMException&&t.name==="AbortError")return;throw t}};v.addEventListener("click",w);w();})();
//# sourceMappingURL=index.js.map
