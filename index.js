(()=>{var h=(o,t,i)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height),o.forEach(e=>w(e,t,i))},w=(o,t,i)=>{let e=Math.min(o.tilePosition[0].x,o.tilePosition[1].x),n=Math.min(o.tilePosition[0].y,o.tilePosition[1].y),r=Math.max(o.tilePosition[0].x,o.tilePosition[1].x),c=Math.max(o.tilePosition[0].y,o.tilePosition[1].y),l={x:e*i,y:n*i},p={x:r*i+i,y:c*i+i};t.strokeStyle="black",t.lineWidth=2,t.beginPath(),t.roundRect(l.x,l.y,p.x-l.x,p.y-l.y,10),t.fillStyle="rgba(0, 0, 0, 0.34)",t.fill(),t.stroke()};var s=class{constructor(t,i){this.x=t;this.y=i}isEqual(t){return this.x===t.x&&this.y===t.y}},b=class{constructor(t){this.tilePosition=t}overlaps(t){return t.tilePosition.some(i=>this.tilePosition.some(e=>e.isEqual(i)))}},d=class o{constructor(t,i,e){this.width=t;this.height=i;this.tiles=e}occupiedPositions(){return this.tiles.flatMap(t=>t.tilePosition)}isInBounds(t){return t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height}isFreePosition(t){return this.isInBounds(t)&&!this.occupiedPositions().some(i=>i.isEqual(t))}freePositions(){let t=[];for(let i=0;i<this.width;i++)for(let e=0;e<this.height;e++){let n=new s(i,e);this.isFreePosition(n)&&t.push(n)}return t}isComplete(){return this.occupiedPositions().length===this.width*this.height}generateChildren(){let t=this.freePositions().map(n=>({value:n,rank:Math.random()})).toSorted((n,r)=>n.rank-r.rank).map(({value:n})=>n);if(t.length===0)return[];let i=null,e=[];for(let n of t){let r=[new s(n.x-1,n.y),new s(n.x+1,n.y),new s(n.x,n.y-1),new s(n.x,n.y+1)].filter(c=>this.isFreePosition(c));(i===null||r.length<e.length)&&(i=n,e=r)}return e.map(n=>{let r=new b([i,n]);return new o(this.width,this.height,[...this.tiles,r])})}},a=class{constructor(t,i,e=[],n=!1,r=!0){this.parent=t;this.tiling=i;this.children=e;this.visited=n;this.viable=r}};function*y(o,t){let e=new a(null,new d(o,t,[]));for(;!e.tiling.isComplete();){if(yield e.tiling.tiles,!e.viable&&(e=e.parent,!e))throw new Error("No complete tiling found");e.visited||(e.children=e.tiling.generateChildren().map(r=>new a(e,r)),e.visited=!0);let n=e.children.filter(r=>r.viable);if(n.length===0){e.viable=!1;continue}e=n[Math.floor(Math.random()*n.length)]}return e.tiling.tiles}var x=document.getElementById("generate-button"),v=document.querySelector("canvas"),g=v.getContext("2d"),u=null,E=1e3,m=30,f=E/m,P=async()=>{u&&u.abort(),u=new AbortController;let o=u.signal;try{let t=y(m,m),i=t.next();for(h(i.value,g,f);!i.done;){if(o.aborted)return;await new Promise((e,n)=>{let r=setTimeout(e,1);o.addEventListener("abort",()=>{clearTimeout(r),n(new DOMException("Operation cancelled","AbortError"))})}),i=t.next(),h(i.value,g,f)}}catch(t){if(t instanceof DOMException&&t.name==="AbortError")return;throw t}};x.addEventListener("click",P);P();})();
//# sourceMappingURL=index.js.map
