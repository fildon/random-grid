(()=>{var u=(n,e)=>{e.clearRect(0,0,e.canvas.width,e.canvas.height),n.forEach(i=>y(i,e))},y=(n,e)=>{let i=Math.min(n.tilePosition[0].x,n.tilePosition[1].x),o=Math.min(n.tilePosition[0].y,n.tilePosition[1].y),t=Math.max(n.tilePosition[0].x,n.tilePosition[1].x),r=Math.max(n.tilePosition[0].y,n.tilePosition[1].y),l={x:i*50,y:o*50},b={x:t*50+50,y:r*50+50};e.strokeStyle="black",e.lineWidth=2,e.beginPath(),e.roundRect(l.x,l.y,b.x-l.x,b.y-l.y,10),e.fillStyle="rgba(0, 0, 0, 0.34)",e.fill(),e.stroke()};var s=class{constructor(e,i){this.x=e;this.y=i}isEqual(e){return this.x===e.x&&this.y===e.y}},h=class{constructor(e){this.tilePosition=e}overlaps(e){return e.tilePosition.some(i=>this.tilePosition.some(o=>o.isEqual(i)))}},d=class n{constructor(e,i,o){this.width=e;this.height=i;this.tiles=o}occupiedPositions(){return this.tiles.flatMap(e=>e.tilePosition)}isInBounds(e){return e.x>=0&&e.x<this.width&&e.y>=0&&e.y<this.height}isFreePosition(e){return this.isInBounds(e)&&!this.occupiedPositions().some(i=>i.isEqual(e))}freePositions(){let e=[];for(let i=0;i<this.width;i++)for(let o=0;o<this.height;o++){let t=new s(i,o);this.isFreePosition(t)&&e.push(t)}return e}isComplete(){return this.occupiedPositions().length===this.width*this.height}generateChildren(){let e=this.freePositions().map(t=>({value:t,rank:Math.random()})).toSorted((t,r)=>t.rank-r.rank).map(({value:t})=>t);if(e.length===0)return[];let i=null,o=[];for(let t of e){let r=[new s(t.x-1,t.y),new s(t.x+1,t.y),new s(t.x,t.y-1),new s(t.x,t.y+1)].filter(l=>this.isFreePosition(l));(i===null||r.length<o.length)&&(i=t,o=r)}return o.map(t=>{let r=new h([i,t]);return new n(this.width,this.height,[...this.tiles,r])})}},a=class{constructor(e,i,o=[],t=!1,r=!0){this.parent=e;this.tiling=i;this.children=o;this.visited=t;this.viable=r}};function*m(){let e=new a(null,new d(20,20,[]));for(;!e.tiling.isComplete();){if(yield e.tiling.tiles,!e.viable&&(e=e.parent,!e))throw new Error("No complete tiling found");e.visited||(e.children=e.tiling.generateChildren().map(o=>new a(e,o)),e.visited=!0);let i=e.children.filter(o=>o.viable);if(i.length===0){e.viable=!1;continue}e=i[Math.floor(Math.random()*i.length)]}return e.tiling.tiles}var f=document.getElementById("generate-button"),P=document.querySelector("canvas"),p=P.getContext("2d"),c=null,g=async()=>{c&&c.abort(),c=new AbortController;let n=c.signal;try{let e=m(),i=e.next();for(u(i.value,p);!i.done;){if(n.aborted)return;await new Promise((o,t)=>{let r=setTimeout(o,10);n.addEventListener("abort",()=>{clearTimeout(r),t(new DOMException("Operation cancelled","AbortError"))})}),i=e.next(),u(i.value,p)}}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}};f.addEventListener("click",g);g();})();
//# sourceMappingURL=index.js.map
