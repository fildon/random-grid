(()=>{var b=(o,i)=>{o.forEach(e=>m(e,i))},m=(o,i)=>{let e=Math.min(o.tilePosition[0].x,o.tilePosition[1].x),n=Math.min(o.tilePosition[0].y,o.tilePosition[1].y),t=Math.max(o.tilePosition[0].x,o.tilePosition[1].x),s=Math.max(o.tilePosition[0].y,o.tilePosition[1].y),l={x:e*100,y:n*100},d={x:t*100+100,y:s*100+100};i.strokeStyle="black",i.lineWidth=2,i.beginPath(),i.roundRect(l.x,l.y,d.x-l.x,d.y-l.y,10),i.fillStyle="rgba(0, 0, 0, 0.34)",i.fill(),i.stroke()};var r=class{constructor(i,e){this.x=i;this.y=e}isEqual(i){return this.x===i.x&&this.y===i.y}},h=class{constructor(i){this.tilePosition=i}overlaps(i){let[e,n]=this.tilePosition;return i.tilePosition.some(t=>e.isEqual(t)||n.isEqual(t))}},c=class o{constructor(i,e,n){this.width=i;this.height=e;this.tiles=n}canPlaceTile(i){let e=this.tiles.some(t=>i.overlaps(t)),n=i.tilePosition.every(t=>t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height);return!e&&n}generateChildren(){let i=this.freePositions();if(i.length===0)return[];let e=null,n=[];for(let t of i){let s=[new r(t.x-1,t.y),new r(t.x+1,t.y),new r(t.x,t.y-1),new r(t.x,t.y+1)].filter(l=>this.isFreePosition(l));(e===null||s.length<n.length)&&(e=t,n=s)}return n.map(t=>{let s=new h([e,t]);if(!this.canPlaceTile(s))throw new Error("Logic error: cannot place tile");return new o(this.width,this.height,[...this.tiles,s])})}occupiedPositions(){return this.tiles.flatMap(i=>i.tilePosition)}isInBounds(i){return i.x>=0&&i.x<this.width&&i.y>=0&&i.y<this.height}isFreePosition(i){return this.isInBounds(i)&&!this.occupiedPositions().some(e=>e.isEqual(i))}freePositions(){let i=[];for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){let t=new r(e,n);this.isFreePosition(t)&&i.push(t)}return i}isComplete(){return this.occupiedPositions().length===this.width*this.height}hasOverlaps(){for(let i=0;i<this.tiles.length;i++)for(let e=i+1;e<this.tiles.length;e++)if(this.tiles[i].overlaps(this.tiles[e]))return!0;return!1}},a=class{constructor(i,e,n=[],t=!1,s=!0){this.parent=i;this.tiling=e;this.children=n;this.visited=t;this.viable=s}countVisited(){return(this.visited?1:0)+this.children.reduce((i,e)=>i+e.countVisited(),0)}countViable(){return(this.viable?1:0)+this.children.reduce((i,e)=>i+e.countViable(),0)}},g=()=>{let i=new a(null,new c(10,10,[]));for(;!i.tiling.isComplete();){if(!i.viable&&(i=i.parent,!i))throw new Error("No complete tiling found");i.visited||(i.children=i.tiling.generateChildren().map(n=>new a(i,n)),i.visited=!0);let e=i.children.filter(n=>n.viable);if(e.length===0){i.viable=!1;continue}i=e[Math.floor(Math.random()*e.length)]}return i.tiling.tiles};var f=document.getElementById("generate-button"),u=document.querySelector("canvas"),y=u.getContext("2d"),P=()=>{y.clearRect(0,0,u.width,u.height);let o=g();b(o,y)};f.addEventListener("click",P);P();})();
//# sourceMappingURL=index.js.map
